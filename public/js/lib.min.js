function StringBuffer(){this.buffer=[]}function Utf8EncodeEnumerator(e){this._input=e,this._index=-1,this._buffer=[]}function Base64DecodeEnumerator(e){this._input=e,this._index=-1,this._buffer=[]}(function(e){if("undefined"!=typeof exports&&"undefined"!=typeof require)var t=e.jQuery||e.Zepto||e.ender||require("jquery"),i=e._||require("underscore"),s=e.Backbone||require("backbone");else var t=e.jQuery,i=e._,s=e.Backbone;var n=function(){return s.View.extend({hasFocus:!1,initialize:function(e){if(!n.templates.form)throw Error("Templates not loaded");if(this.schema=function(){if(e.schema)return e.schema;var t=e.model;if(!t)throw Error("Could not find schema");return i.isFunction(t.schema)?t.schema():t.schema}(),e=i.extend({template:"form",fieldsetTemplate:"fieldset",fieldTemplate:"field"},e),!e.fieldsets){var t=e.fields||i.keys(this.schema);e.fieldsets=[{fields:t}]}this.options=e,this.model=e.model,this.data=e.data,this.fields={}},render:function(){var e=this,s=this.options,r=n.templates[s.template],a=n.helpers.parseHTML(r({fieldsets:'<b class="bbf-tmp"></b>'})),o=t(".bbf-tmp",a);return i.each(s.fieldsets,function(t){o.append(e.renderFieldset(t))}),o.children().unwrap(),this.setElement(a),this.hasFocus&&this.trigger("blur",this),this},renderFieldset:function(e){var s=this,r=n.templates[this.options.fieldsetTemplate],a=this.schema,o=n.helpers.getNested;i.isArray(e)&&(e={fields:e});var l=n.helpers.parseHTML(r(i.extend({},e,{legend:'<b class="bbf-tmp-legend"></b>',fields:'<b class="bbf-tmp-fields"></b>'})));e.legend?l.find(".bbf-tmp-legend").replaceWith(e.legend):l.find(".bbf-tmp-legend").parent().remove();var h=t(".bbf-tmp-fields",l);return i.each(e.fields,function(e){var t=function(){if(a[e])return a[e];var t=e.replace(/\./g,".subSchema.");return o(a,t)}();if(!t)throw"Field '"+e+"' not found in schema";var n=s.fields[e]=s.createField(e,t),r=n.render().el;n.editor.on("all",function(t){var s=i.toArray(arguments);s[0]=e+":"+t,s.splice(1,0,this),this.trigger.apply(this,s)},s),n.editor.on("change",function(){this.trigger("change",s)},s),n.editor.on("focus",function(){this.hasFocus||this.trigger("focus",this)},s),n.editor.on("blur",function(){if(this.hasFocus){var e=this;setTimeout(function(){i.find(e.fields,function(e){return e.editor.hasFocus})||e.trigger("blur",e)},0)}},s),"Hidden"!==t.type&&h.append(r)}),h=h.children().unwrap(),l},createField:function(e,t){t.template=t.template||this.options.fieldTemplate;var i={form:this,key:e,schema:t,idPrefix:this.options.idPrefix,template:this.options.fieldTemplate};return this.model?i.model=this.model:i.value=this.data?this.data[e]:null,new n.Field(i)},validate:function(){var e=this,t=this.fields,s=this.model,n={};if(i.each(t,function(e){var t=e.validate();t&&(n[e.key]=t)}),s&&s.validate){var r=s.validate(this.getValue());if(r){var a=i.isObject(r)&&!i.isArray(r);a||(n._others=n._others||[],n._others.push(r)),a&&i.each(r,function(t,i){if(e.fields[i]&&!n[i])e.fields[i].setError(t),n[i]=t;else{n._others=n._others||[];var s={};s[i]=t,n._others.push(s)}})}}return i.isEmpty(n)?null:n},commit:function(e){var t=this.validate();if(t)return t;var s,n=i.extend({error:function(e,t){s=t}},e);return this.model.set(this.getValue(),n),s?s:void 0},getValue:function(e){if(e)return this.fields[e].getValue();var t={};return i.each(this.fields,function(e){t[e.key]=e.getValue()}),t},setValue:function(e,t){var i={};"string"==typeof e?i[e]=t:i=e;var s;for(s in this.schema)void 0!==i[s]&&this.fields[s].setValue(i[s])},focus:function(){if(!this.hasFocus){var e=this.options.fieldsets[0];if(e){var t;t=i.isArray(e)?e[0]:e.fields[0],t&&this.fields[t].editor.focus()}}},blur:function(){if(this.hasFocus){var e=i.find(this.fields,function(e){return e.editor.hasFocus});e&&e.editor.blur()}},remove:function(){var e=this.fields;for(var t in e)e[t].remove();s.View.prototype.remove.call(this)},trigger:function(e){return"focus"===e?this.hasFocus=!0:"blur"===e&&(this.hasFocus=!1),s.View.prototype.trigger.apply(this,arguments)}})}();n.helpers=function(){var e={};return e.getNested=function(e,t){for(var i=t.split("."),s=e,n=0,r=i.length;r>n;n++)s=s[i[n]];return s},e.keyToTitle=function(e){return e=e.replace(/([A-Z])/g," $1"),e=e.replace(/^./,function(e){return e.toUpperCase()})},e.compileTemplate=function(e){var t=i.templateSettings.interpolate;i.templateSettings.interpolate=/\{\{(.+?)\}\}/g;var s=i.template(e);return i.templateSettings.interpolate=t,s},e.createTemplate=function(i,s){var n=e.compileTemplate(t.trim(i));return s?n(s):n},e.setTemplateCompiler=function(t){e.compileTemplate=t},e.setTemplates=function(t,s){var r=e.createTemplate;n.templates=n.templates||{},n.classNames=n.classNames||{},i.each(t,function(e,t){i.isString(e)&&(e=r(e)),n.templates[t]=e}),i.extend(n.classNames,s)},e.createEditor=function(e,t){var s;return s=i.isString(e)?n.editors[e]:e,new s(t)},e.getValidator=function(e){var t=n.validators;if(i.isRegExp(e))return t.regexp({regexp:e});if(i.isString(e)){if(!t[e])throw Error('Validator "'+e+'" not found');return t[e]()}if(i.isFunction(e))return e;if(i.isObject(e)&&e.type){var s=e;return t[s.type](s)}throw Error("Invalid validator: "+e)},e.parseHTML=function(e){return void 0!==t.parseHTML?t(t.parseHTML(e)):t(e)},e}(),n.validators=function(){var e={};return e.errMessages={required:"Required",regexp:"Invalid",email:"Invalid email address",url:"Invalid URL",match:'Must match field "{{field}}"'},e.required=function(e){return e=i.extend({type:"required",message:this.errMessages.required},e),function(t){e.value=t;var i={type:e.type,message:n.helpers.createTemplate(e.message,e)};return null===t||void 0===t||t===!1||""===t?i:void 0}},e.regexp=function(e){if(!e.regexp)throw Error('Missing required "regexp" option for "regexp" validator');return e=i.extend({type:"regexp",message:this.errMessages.regexp},e),function(t){e.value=t;var i={type:e.type,message:n.helpers.createTemplate(e.message,e)};if(null!==t&&void 0!==t&&""!==t)return e.regexp.test(t)?void 0:i}},e.email=function(t){return t=i.extend({type:"email",message:this.errMessages.email,regexp:/^[\w\-]{1,}([\w\-\+.]{1,1}[\w\-]{1,}){0,}[@][\w\-]{1,}([.]([\w\-]{1,})){1,3}$/},t),e.regexp(t)},e.url=function(t){return t=i.extend({type:"url",message:this.errMessages.url,regexp:/^(http|https):\/\/(([A-Z0-9][A-Z0-9_\-]*)(\.[A-Z0-9][A-Z0-9_\-]*)+)(:(\d+))?\/?/i},t),e.regexp(t)},e.match=function(e){if(!e.field)throw Error('Missing required "field" options for "match" validator');return e=i.extend({type:"match",message:this.errMessages.match},e),function(t,i){e.value=t;var s={type:e.type,message:n.helpers.createTemplate(e.message,e)};if(null!==t&&void 0!==t&&""!==t)return t!==i[e.field]?s:void 0}},e}(),n.Field=function(){var e=n.helpers;return n.templates,s.View.extend({initialize:function(t){t=t||{},this.form=t.form,this.key=t.key,this.value=t.value,this.model=t.model,i.isString(t.schema)&&(t.schema={type:t.schema}),this.schema=i.extend({type:"Text",title:e.keyToTitle(this.key),template:"field"},t.schema)},renderingContext:function(e,t){return{key:this.key,title:e.title,id:t.id,type:e.type,editor:'<b class="bbf-tmp-editor"></b>',help:'<b class="bbf-tmp-help"></b>',error:'<b class="bbf-tmp-error"></b>'}},render:function(){var i=this.schema,s=n.templates,r={form:this.form,key:this.key,schema:i,idPrefix:this.options.idPrefix,id:this.getId()};this.model?r.model=this.model:r.value=this.value;var a=this.editor=e.createEditor(i.type,r),o=n.helpers.parseHTML(s[i.template](this.renderingContext(i,a)));return i.title===!1&&o.find('label[for="'+a.id+'"]').first().remove(),o.find(".bbf-tmp-editor").replaceWith(a.render().el),this.$help=t(".bbf-tmp-help",o).parent(),this.$help.empty(),this.schema.help&&this.$help.html(this.schema.help),this.$error=t(t(".bbf-tmp-error",o).parent()[0]),this.$error&&this.$error.empty(),this.schema.fieldClass&&o.addClass(this.schema.fieldClass),this.schema.fieldAttrs&&o.attr(this.schema.fieldAttrs),this.setElement(o),this},getId:function(){var e=this.options.idPrefix,t=this.key;return t=t.replace(/\./g,"_"),i.isString(e)||i.isNumber(e)?e+t:i.isNull(e)?t:this.model?this.model.cid+"_"+t:t},validate:function(){var e=this.editor.validate();return e?this.setError(e.message):this.clearError(),e},setError:function(e){if(!this.editor.hasNestedForm){var t=n.classNames.error;this.$el.addClass(t),this.$error?this.$error.html(e):this.$help&&this.$help.html(e)}},clearError:function(){var e=n.classNames.error;if(this.$el.removeClass(e),this.$error)this.$error.empty();else if(this.$help){this.$help.empty();var t=this.schema.help;t&&this.$help.html(t)}},commit:function(){return this.editor.commit()},getValue:function(){return this.editor.getValue()},setValue:function(e){this.editor.setValue(e)},focus:function(){this.editor.focus()},blur:function(){this.editor.blur()},remove:function(){this.editor.remove(),s.View.prototype.remove.call(this)}})}(),n.editors=function(){n.helpers;var e={};return e.Base=s.View.extend({defaultValue:null,hasFocus:!1,initialize:function(e){var e=e||{};if(e.model){if(!e.key)throw"Missing option: 'key'";this.model=e.model,this.value=this.model.get(e.key)}else e.value&&(this.value=e.value);void 0===this.value&&(this.value=this.defaultValue),this.key=e.key,this.form=e.form,this.schema=e.schema||{},this.validators=e.validators||this.schema.validators,this.$el.attr("name",this.getName()),this.schema.editorClass&&this.$el.addClass(this.schema.editorClass),this.schema.editorAttrs&&this.$el.attr(this.schema.editorAttrs)},getValue:function(){throw"Not implemented. Extend and override this method."},setValue:function(){throw"Not implemented. Extend and override this method."},focus:function(){throw"Not implemented. Extend and override this method."},blur:function(){throw"Not implemented. Extend and override this method."},getName:function(){var e=this.key||"";return e.replace(/\./g,"_")},commit:function(e){var t=this.validate();return t?t:(this.listenTo(this.model,"invalid",function(e,i){t=i}),this.model.set(this.key,this.getValue(),e),t?t:void 0)},validate:function(){var e=(this.$el,null),t=this.getValue(),s=this.form?this.form.getValue():{},r=this.validators,a=n.helpers.getValidator;return r&&i.every(r,function(i){return e=a(i)(t,s),e?!1:!0}),e},trigger:function(e){return"focus"===e?this.hasFocus=!0:"blur"===e&&(this.hasFocus=!1),s.View.prototype.trigger.apply(this,arguments)}}),e.Text=e.Base.extend({tagName:"input",defaultValue:"",previousValue:"",events:{keyup:"determineChange",keypress:function(){var e=this;setTimeout(function(){e.determineChange()},0)},select:function(){this.trigger("select",this)},focus:function(){this.trigger("focus",this)},blur:function(){this.trigger("blur",this)}},initialize:function(t){e.Base.prototype.initialize.call(this,t);var i=this.schema,s="text";i&&i.editorAttrs&&i.editorAttrs.type&&(s=i.editorAttrs.type),i&&i.dataType&&(s=i.dataType),this.$el.attr("type",s)},render:function(){return this.setValue(this.value),this},determineChange:function(){var e=this.$el.val(),t=e!==this.previousValue;t&&(this.previousValue=e,this.trigger("change",this))},getValue:function(){return this.$el.val()},setValue:function(e){this.$el.val(e)},focus:function(){this.hasFocus||this.$el.focus()},blur:function(){this.hasFocus&&this.$el.blur()},select:function(){this.$el.select()}}),e.Number=e.Text.extend({defaultValue:0,events:i.extend({},e.Text.prototype.events,{keypress:"onKeyPress"}),initialize:function(t){e.Text.prototype.initialize.call(this,t),this.$el.attr("type","number"),this.$el.attr("step","any")},onKeyPress:function(e){var t=this,i=function(){setTimeout(function(){t.determineChange()},0)};if(0===e.charCode)return i(),void 0;var s=this.$el.val()+String.fromCharCode(e.charCode),n=/^[0-9]*\.?[0-9]*?$/.test(s);n?i():e.preventDefault()},getValue:function(){var e=this.$el.val();return""===e?null:parseFloat(e,10)},setValue:function(t){t=function(){return i.isNumber(t)?t:i.isString(t)&&""!==t?parseFloat(t,10):null}(),i.isNaN(t)&&(t=null),e.Text.prototype.setValue.call(this,t)}}),e.Password=e.Text.extend({initialize:function(t){e.Text.prototype.initialize.call(this,t),this.$el.attr("type","password")}}),e.TextArea=e.Text.extend({tagName:"textarea"}),e.Checkbox=e.Base.extend({defaultValue:!1,tagName:"input",events:{click:function(){this.trigger("change",this)},focus:function(){this.trigger("focus",this)},blur:function(){this.trigger("blur",this)}},initialize:function(t){e.Base.prototype.initialize.call(this,t),this.$el.attr("type","checkbox")},render:function(){return this.setValue(this.value),this},getValue:function(){return this.$el.prop("checked")},setValue:function(e){e&&this.$el.prop("checked",!0)},focus:function(){this.hasFocus||this.$el.focus()},blur:function(){this.hasFocus&&this.$el.blur()}}),e.Hidden=e.Base.extend({defaultValue:"",initialize:function(t){e.Text.prototype.initialize.call(this,t),this.$el.attr("type","hidden")},getValue:function(){return this.value},setValue:function(e){this.value=e},focus:function(){},blur:function(){}}),e.Select=e.Base.extend({tagName:"select",events:{change:function(){this.trigger("change",this)},focus:function(){this.trigger("focus",this)},blur:function(){this.trigger("blur",this)}},initialize:function(t){if(e.Base.prototype.initialize.call(this,t),!this.schema||!this.schema.options)throw"Missing required 'schema.options'"},render:function(){return this.setOptions(this.schema.options),this},setOptions:function(e){var t=this;if(e instanceof s.Collection){var n=e;n.length>0?this.renderOptions(e):n.fetch({success:function(){t.renderOptions(e)}})}else i.isFunction(e)?e(function(e){t.renderOptions(e)},t):this.renderOptions(e)},renderOptions:function(e){var t,i=this.$el;t=this._getOptionsHtml(e),i.html(t),this.setValue(this.value)},_getOptionsHtml:function(e){var t;if(i.isString(e))t=e;else if(i.isArray(e))t=this._arrayToHtml(e);else if(e instanceof s.Collection)t=this._collectionToHtml(e);else if(i.isFunction(e)){var n;e(function(e){n=e},this),t=this._getOptionsHtml(n)}return t},getValue:function(){return this.$el.val()},setValue:function(e){this.$el.val(e)},focus:function(){this.hasFocus||this.$el.focus()},blur:function(){this.hasFocus&&this.$el.blur()},_collectionToHtml:function(e){var t=[];e.each(function(e){t.push({val:e.id,label:""+e})});var i=this._arrayToHtml(t);return i},_arrayToHtml:function(e){var t=[];return i.each(e,function(e){if(i.isObject(e))if(e.group)t.push('<optgroup label="'+e.group+'">'),t.push(this._getOptionsHtml(e.options)),t.push("</optgroup>");else{var s=e.val||0===e.val?e.val:"";t.push('<option value="'+s+'">'+e.label+"</option>")}else t.push("<option>"+e+"</option>")},this),t.join("")}}),e.Radio=e.Select.extend({tagName:"ul",className:"bbf-radio",events:{"change input[type=radio]":function(){this.trigger("change",this)},"focus input[type=radio]":function(){this.hasFocus||this.trigger("focus",this)},"blur input[type=radio]":function(){if(this.hasFocus){var e=this;setTimeout(function(){e.$("input[type=radio]:focus")[0]||e.trigger("blur",e)},0)}}},getValue:function(){return this.$("input[type=radio]:checked").val()},setValue:function(e){this.$("input[type=radio]").val([e])},focus:function(){if(!this.hasFocus){var e=this.$("input[type=radio]:checked");return e[0]?(e.focus(),void 0):(this.$("input[type=radio]").first().focus(),void 0)}},blur:function(){this.hasFocus&&this.$("input[type=radio]:focus").blur()},_arrayToHtml:function(e){var t=[],s=this;return i.each(e,function(e,n){var r="<li>";if(i.isObject(e)){var a=e.val||0===e.val?e.val:"";r+='<input type="radio" name="'+s.id+'" value="'+a+'" id="'+s.id+"-"+n+'" />',r+='<label for="'+s.id+"-"+n+'">'+e.label+"</label>"}else r+='<input type="radio" name="'+s.id+'" value="'+e+'" id="'+s.id+"-"+n+'" />',r+='<label for="'+s.id+"-"+n+'">'+e+"</label>";r+="</li>",t.push(r)}),t.join("")}}),e.Checkboxes=e.Select.extend({tagName:"ul",className:"bbf-checkboxes",events:{"click input[type=checkbox]":function(){this.trigger("change",this)},"focus input[type=checkbox]":function(){this.hasFocus||this.trigger("focus",this)},"blur input[type=checkbox]":function(){if(this.hasFocus){var e=this;setTimeout(function(){e.$("input[type=checkbox]:focus")[0]||e.trigger("blur",e)},0)}}},getValue:function(){var e=[];return this.$("input[type=checkbox]:checked").each(function(){e.push(t(this).val())}),e},setValue:function(e){i.isArray(e)||(e=[e]),this.$("input[type=checkbox]").val(e)},focus:function(){this.hasFocus||this.$("input[type=checkbox]").first().focus()},blur:function(){this.hasFocus&&this.$("input[type=checkbox]:focus").blur()},_arrayToHtml:function(e){var t=[],s=this;return i.each(e,function(e,n){var r="<li>";if(i.isObject(e)){var a=e.val||0===e.val?e.val:"";r+='<input type="checkbox" name="'+s.id+'" value="'+a+'" id="'+s.id+"-"+n+'" />',r+='<label for="'+s.id+"-"+n+'">'+e.label+"</label>"}else r+='<input type="checkbox" name="'+s.id+'" value="'+e+'" id="'+s.id+"-"+n+'" />',r+='<label for="'+s.id+"-"+n+'">'+e+"</label>";r+="</li>",t.push(r)}),t.join("")}}),e.Object=e.Base.extend({hasNestedForm:!0,className:"bbf-object",initialize:function(t){if(this.value={},e.Base.prototype.initialize.call(this,t),!this.schema.subSchema)throw Error("Missing required 'schema.subSchema' option for Object editor")},render:function(){return this.form=new n({schema:this.schema.subSchema,data:this.value,idPrefix:this.id+"_",fieldTemplate:"nestedField"}),this._observeFormEvents(),this.$el.html(this.form.render().el),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){return this.form?this.form.getValue():this.value},setValue:function(e){this.value=e,this.render()},focus:function(){this.hasFocus||this.form.focus()},blur:function(){this.hasFocus&&this.form.blur()},remove:function(){this.form.remove(),s.View.prototype.remove.call(this)},validate:function(){return this.form.validate()},_observeFormEvents:function(){this.form.on("all",function(){var e=i.toArray(arguments);e[1]=this,this.trigger.apply(this,e)},this)}}),e.NestedModel=e.Object.extend({initialize:function(t){if(e.Base.prototype.initialize.call(this,t),!t.schema.model)throw'Missing required "schema.model" option for NestedModel editor'},render:function(){var e=this.value||{},t=(this.key,this.schema.model),i=e.constructor===t?e:new t(e);return this.form=new n({model:i,idPrefix:this.id+"_",fieldTemplate:"nestedField"}),this._observeFormEvents(),this.$el.html(this.form.render().el),this.hasFocus&&this.trigger("blur",this),this},commit:function(){var t=this.form.commit();return t?(this.$el.addClass("error"),t):e.Object.prototype.commit.call(this)}}),e.Date=e.Base.extend({events:{"change select":function(){this.updateHidden(),this.trigger("change",this)},"focus select":function(){this.hasFocus||this.trigger("focus",this)},"blur select":function(){if(this.hasFocus){var e=this;setTimeout(function(){e.$("select:focus")[0]||e.trigger("blur",e)},0)}}},initialize:function(t){t=t||{},e.Base.prototype.initialize.call(this,t);var s=e.Date,n=new Date;if(this.options=i.extend({monthNames:s.monthNames,showMonthNames:s.showMonthNames},t),this.schema=i.extend({yearStart:n.getFullYear()-100,yearEnd:n.getFullYear()},t.schema||{}),this.value&&!i.isDate(this.value)&&(this.value=new Date(this.value)),!this.value){var r=new Date;r.setSeconds(0),r.setMilliseconds(0),this.value=r}},render:function(){var e=this.options,s=this.schema,r=i.map(i.range(1,32),function(e){return'<option value="'+e+'">'+e+"</option>"}),a=i.map(i.range(0,12),function(t){var i=e.showMonthNames?e.monthNames[t]:t+1;return'<option value="'+t+'">'+i+"</option>"}),o=s.yearStart<s.yearEnd?i.range(s.yearStart,s.yearEnd+1):i.range(s.yearStart,s.yearEnd-1,-1),l=i.map(o,function(e){return'<option value="'+e+'">'+e+"</option>"}),h=n.helpers.parseHTML(n.templates.date({dates:r.join(""),months:a.join(""),years:l.join("")}));return this.$date=h.find('select[data-type="date"]'),this.$month=h.find('select[data-type="month"]'),this.$year=h.find('select[data-type="year"]'),this.$hidden=t('<input type="hidden" name="'+this.key+'" />'),h.append(this.$hidden),this.setValue(this.value),this.setElement(h),this.$el.attr("id",this.id),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){var e=this.$year.val(),t=this.$month.val(),i=this.$date.val();return e&&t&&i?new Date(e,t,i):null},setValue:function(e){this.$date.val(e.getDate()),this.$month.val(e.getMonth()),this.$year.val(e.getFullYear()),this.updateHidden()},focus:function(){this.hasFocus||this.$("select").first().focus()},blur:function(){this.hasFocus&&this.$("select:focus").blur()},updateHidden:function(){var e=this.getValue();i.isDate(e)&&(e=e.toISOString()),this.$hidden.val(e)}},{showMonthNames:!0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"]}),e.DateTime=e.Base.extend({events:{"change select":function(){this.updateHidden(),this.trigger("change",this)},"focus select":function(){this.hasFocus||this.trigger("focus",this)},"blur select":function(){if(this.hasFocus){var e=this;setTimeout(function(){e.$("select:focus")[0]||e.trigger("blur",e)},0)}}},initialize:function(t){t=t||{},e.Base.prototype.initialize.call(this,t),this.options=i.extend({DateEditor:e.DateTime.DateEditor},t),this.schema=i.extend({minsInterval:15},t.schema||{}),this.dateEditor=new this.options.DateEditor(t),this.value=this.dateEditor.value},render:function(){function e(e){return 10>e?"0"+e:e}var t=this.schema,s=i.map(i.range(0,24),function(t){return'<option value="'+t+'">'+e(t)+"</option>"}),r=i.map(i.range(0,60,t.minsInterval),function(t){return'<option value="'+t+'">'+e(t)+"</option>"}),a=n.helpers.parseHTML(n.templates.dateTime({date:'<b class="bbf-tmp"></b>',hours:s.join(),mins:r.join()}));return a.find(".bbf-tmp").replaceWith(this.dateEditor.render().el),this.$hour=a.find('select[data-type="hour"]'),this.$min=a.find('select[data-type="min"]'),this.$hidden=a.find('input[type="hidden"]'),this.setValue(this.value),this.setElement(a),this.$el.attr("id",this.id),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){var e=this.dateEditor.getValue(),t=this.$hour.val(),i=this.$min.val();return e&&t&&i?(e.setHours(t),e.setMinutes(i),e):null},setValue:function(e){i.isDate(e)||(e=new Date(e)),this.dateEditor.setValue(e),this.$hour.val(e.getHours()),this.$min.val(e.getMinutes()),this.updateHidden()},focus:function(){this.hasFocus||this.$("select").first().focus()},blur:function(){this.hasFocus&&this.$("select:focus").blur()},updateHidden:function(){var e=this.getValue();i.isDate(e)&&(e=e.toISOString()),this.$hidden.val(e)},remove:function(){this.dateEditor.remove(),e.Base.prototype.remove.call(this)}},{DateEditor:e.Date}),e}(),n.setTemplates=n.helpers.setTemplates,n.setTemplateCompiler=n.helpers.setTemplateCompiler,n.templates={},n.setTemplates({form:'      <form class="bbf-form">{{fieldsets}}</form>    ',fieldset:"      <fieldset>        <legend>{{legend}}</legend>        <ul>{{fields}}</ul>      </fieldset>    ",field:'      <li class="bbf-field field-{{key}}">        <label for="{{id}}">{{title}}</label>        <div class="bbf-editor">{{editor}}</div>        <div class="bbf-help">{{help}}</div>        <div class="bbf-error">{{error}}</div>      </li>    ',nestedField:'      <li class="bbf-field bbf-nested-field field-{{key}}" title="{{title}}">        <label for="{{id}}">{{title}}</label>        <div class="bbf-editor">{{editor}}</div>        <div class="bbf-help">{{help}}</div>        <div class="bbf-error">{{error}}</div>      </li>    ',list:'      <div class="bbf-list">        <ul>{{items}}</ul>        <div class="bbf-actions"><button type="button" data-action="add">Add</div>      </div>    ',listItem:'      <li>        <button type="button" data-action="remove" class="bbf-remove">&times;</button>        <div class="bbf-editor-container">{{editor}}</div>      </li>    ',date:'      <div class="bbf-date">        <select data-type="date" class="bbf-date">{{dates}}</select>        <select data-type="month" class="bbf-month">{{months}}</select>        <select data-type="year" class="bbf-year">{{years}}</select>      </div>    ',dateTime:'      <div class="bbf-datetime">        <div class="bbf-date-container">{{date}}</div>        <select data-type="hour">{{hours}}</select>        :        <select data-type="min">{{mins}}</select>      </div>    ',"list.Modal":'      <div class="bbf-list-modal">        {{summary}}      </div>    '},{error:"bbf-error"}),n.VERSION="0.11.0",s.Form=n})(this),function(e,t,i){var s=t.templateSettings;t.templateSettings={interpolate:/\{\{(.+?)\}\}/g,evaluate:/<%([\s\S]+?)%>/g};var n=t.template('    <% if (title) { %>      <div class="modal-header">        <% if (allowCancel) { %>          <a class="close">×</a>        <% } %>        <h3>{{title}}</h3>      </div>    <% } %>    <div class="modal-body">{{content}}</div>    <div class="modal-footer">      <% if (allowCancel) { %>        <% if (cancelText) { %>          <a href="#" class="btn cancel">{{cancelText}}</a>        <% } %>      <% } %>      <a href="#" class="btn ok btn-primary">{{okText}}</a>    </div>  ');t.templateSettings=s;var r=i.View.extend({className:"modal",events:{"click .close":function(e){e.preventDefault(),this.trigger("cancel"),this.options.content&&this.options.content.trigger&&this.options.content.trigger("cancel",this)},"click .cancel":function(e){e.preventDefault(),this.trigger("cancel"),this.options.content&&this.options.content.trigger&&this.options.content.trigger("cancel",this)},"click .ok":function(e){e.preventDefault(),this.trigger("ok"),this.options.content&&this.options.content.trigger&&this.options.content.trigger("ok",this),this.options.okCloses&&this.close()}},initialize:function(e){this.options=t.extend({title:null,okText:"OK",focusOk:!0,okCloses:!0,cancelText:"Cancel",allowCancel:!0,escape:!0,animate:!1,template:n},e)},render:function(){var e=this.$el,t=this.options,i=t.content;return e.html(t.template(t)),this.$content=e.find(".modal-body"),i.$el&&(i.render(),e.find(".modal-body").html(i.$el)),t.animate&&e.addClass("fade"),this.isRendered=!0,this},open:function(i){this.isRendered||this.render();var s=this,n=this.$el;n.modal(t.extend({keyboard:this.options.allowCancel,backdrop:this.options.allowCancel?!0:"static"},this.options.modalOptions)),n.one("shown",function(){s.options.focusOk&&n.find(".btn.ok").focus(),s.options.content&&s.options.content.trigger&&s.options.content.trigger("shown",s),s.trigger("shown")});var a=r.count,o=e(".modal-backdrop:eq("+a+")"),l=parseInt(o.css("z-index"),10),h=parseInt(o.css("z-index"),10);return o.css("z-index",l+a),this.$el.css("z-index",h+a),this.options.allowCancel&&(o.one("click",function(){s.options.content&&s.options.content.trigger&&s.options.content.trigger("cancel",s),s.trigger("cancel")}),e(document).one("keyup.dismiss.modal",function(e){27==e.which&&s.trigger("cancel"),s.options.content&&s.options.content.trigger&&27==e.which&&s.options.content.trigger("shown",s)})),this.on("cancel",function(){s.close()}),r.count++,i&&s.on("ok",i),this},close:function(){var e=this,t=this.$el;return this._preventClose?(this._preventClose=!1,void 0):(t.one("hidden",function i(s){return s.target!==s.currentTarget?t.one("hidden",i):(e.remove(),e.options.content&&e.options.content.trigger&&e.options.content.trigger("hidden",e),e.trigger("hidden"),void 0)}),t.modal("hide"),r.count--,void 0)},preventClose:function(){this._preventClose=!0}},{count:0});return"function"==typeof require&&"undefined"!=typeof module&&exports&&(module.exports=r),"function"==typeof define&&define.amd?define(function(){i.BootstrapModal=r}):(i.BootstrapModal=r,void 0)}(jQuery,_,Backbone),function(){var e=Backbone.Form;e.setTemplates({form:'      <form class="form-horizontal">{{fieldsets}}</form>    ',fieldset:"      <fieldset>        <legend>{{legend}}</legend>        {{fields}}      </fieldset>    ",field:'      <div class="control-group field-{{key}}">        <label class="control-label" for="{{id}}">{{title}}</label>        <div class="controls">          {{editor}}          <div class="help-inline">{{error}}</div>          <div class="help-block">{{help}}</div>        </div>      </div>    ',nestedField:'      <div class="field-{{key}}">        <div title="{{title}}" class="input-xlarge">{{editor}}          <div class="help-inline">{{error}}</div>        </div>        <div class="help-block">{{help}}</div>      </div>    ',list:'      <div class="bbf-list">        <ul class="unstyled clearfix">{{items}}</ul>        <button class="btn bbf-add" data-action="add">Add</button>      </div>    ',listItem:'      <li class="clearfix">        <div class="pull-left">{{editor}}</div>        <button type="button" class="btn bbf-del" data-action="remove">&times;</button>      </li>    ',date:'      <div class="bbf-date">        <select data-type="date" class="bbf-date">{{dates}}</select>        <select data-type="month" class="bbf-month">{{months}}</select>        <select data-type="year" class="bbf-year">{{years}}</select>      </div>    ',dateTime:'      <div class="bbf-datetime">        <p>{{date}}</p>        <p>          <select data-type="hour" style="width: 4em">{{hours}}</select>          :          <select data-type="min" style="width: 4em">{{mins}}</select>        </p>      </div>    ',"list.Modal":'      <div class="bbf-list-modal">        {{summary}}      </div>    '},{error:"error"})}(),function(){var e=Backbone.Form,t=e.editors;t.List=t.Base.extend({events:{'click [data-action="add"]':function(e){e.preventDefault(),this.addItem(null,!0)}},initialize:function(e){t.Base.prototype.initialize.call(this,e);var i=this.schema;if(!i)throw"Missing required option 'schema'";this.schema=_.extend({listTemplate:"list",listItemTemplate:"listItem"},i),this.Editor=function(){var e=i.itemType;return e?t.List[e]?t.List[e]:t[e]:t.Text}(),this.items=[]},render:function(){var t=this,i=this.value||[],s=e.helpers.parseHTML(e.templates[this.schema.listTemplate]({items:'<b class="bbf-tmp"></b>'}));return this.$list=s.find(".bbf-tmp").parent().empty(),i.length?_.each(i,function(e){t.addItem(e)}):this.Editor.isAsync||this.addItem(),this.setElement(s),this.$el.attr("id",this.id),this.$el.attr("name",this.key),this.hasFocus&&this.trigger("blur",this),this},addItem:function(e,i){var s=this,n=new t.List.Item({list:this,schema:this.schema,value:e,Editor:this.Editor,key:this.key}).render(),r=function(){s.items.push(n),s.$list.append(n.el),n.editor.on("all",function(e){if("change"!==e){var i=_.toArray(arguments);i[0]="item:"+e,i.splice(1,0,s),t.List.prototype.trigger.apply(this,i)}},s),n.editor.on("change",function(){n.addEventTriggered||(n.addEventTriggered=!0,this.trigger("add",this,n.editor)),this.trigger("item:change",this,n.editor),this.trigger("change",this)},s),n.editor.on("focus",function(){this.hasFocus||this.trigger("focus",this)},s),n.editor.on("blur",function(){if(this.hasFocus){var e=this;setTimeout(function(){_.find(e.items,function(e){return e.editor.hasFocus})||e.trigger("blur",e)},0)}},s),(i||e)&&(n.addEventTriggered=!0),i&&(s.trigger("add",s,n.editor),s.trigger("change",s))};return this.Editor.isAsync?n.editor.on("readyToAdd",r,this):(r(),n.editor.focus()),n},removeItem:function(e){var t=this.schema.confirmDelete;if(!t||confirm(t)){var i=_.indexOf(this.items,e);this.items[i].remove(),this.items.splice(i,1),e.addEventTriggered&&(this.trigger("remove",this,e.editor),this.trigger("change",this)),this.items.length||this.Editor.isAsync||this.addItem()}},getValue:function(){var e=_.map(this.items,function(e){return e.getValue()});return _.without(e,void 0,"")},setValue:function(e){this.value=e,this.render()},focus:function(){this.hasFocus||this.items[0]&&this.items[0].editor.focus()},blur:function(){if(this.hasFocus){var e=_.find(this.items,function(e){return e.editor.hasFocus});e&&e.editor.blur()}},remove:function(){_.invoke(this.items,"remove"),t.Base.prototype.remove.call(this)},validate:function(){if(!this.validators)return null;var e=_.map(this.items,function(e){return e.validate()}),t=_.compact(e).length?!0:!1;if(!t)return null;var i={type:"list",message:"Some of the items in the list failed validation",errors:e};
return i}}),t.List.Item=Backbone.View.extend({events:{'click [data-action="remove"]':function(e){e.preventDefault(),this.list.removeItem(this)},"keydown input[type=text]":function(e){13===e.keyCode&&(e.preventDefault(),this.list.addItem(),this.list.$list.find("> li:last input").focus())}},initialize:function(e){this.list=e.list,this.schema=e.schema||this.list.schema,this.value=e.value,this.Editor=e.Editor||t.Text,this.key=e.key},render:function(){this.editor=new this.Editor({key:this.key,schema:this.schema,value:this.value,list:this.list,item:this}).render();var t=e.helpers.parseHTML(e.templates[this.schema.listItemTemplate]({editor:'<b class="bbf-tmp"></b>'}));return t.find(".bbf-tmp").replaceWith(this.editor.el),this.setElement(t),this},getValue:function(){return this.editor.getValue()},setValue:function(e){this.editor.setValue(e)},focus:function(){this.editor.focus()},blur:function(){this.editor.blur()},remove:function(){this.editor.remove(),Backbone.View.prototype.remove.call(this)},validate:function(){var t=this.getValue(),i=this.list.form?this.list.form.getValue():{},s=this.schema.validators,n=e.helpers.getValidator;if(!s)return null;var r=null;return _.every(s,function(e){return r=n(e)(t,i),r?!1:!0}),r?this.setError(r):this.clearError(),r?r:null},setError:function(t){this.$el.addClass(e.classNames.error),this.$el.attr("title",t.message)},clearError:function(){this.$el.removeClass(e.classNames.error),this.$el.attr("title",null)}}),t.List.Modal=t.Base.extend({events:{click:"openEditor"},initialize:function(e){if(t.Base.prototype.initialize.call(this,e),!t.List.Modal.ModalAdapter)throw"A ModalAdapter is required"},render:function(){var e=this;return _.isEmpty(this.value)?this.openEditor():(this.renderSummary(),setTimeout(function(){e.trigger("readyToAdd")},0)),this.hasFocus&&this.trigger("blur",this),this},renderSummary:function(){var t=e.templates["list.Modal"];this.$el.html(t({summary:this.getStringValue()}))},itemToString:function(t){t=t||{};var i=[];return _.each(this.nestedSchema,function(s,n){var r=s.title?s.title:e.helpers.keyToTitle(n),a=t[n];(_.isUndefined(a)||_.isNull(a))&&(a=""),i.push(r+": "+a)}),i.join("<br />")},getStringValue:function(){var e=this.schema,t=this.getValue();return _.isEmpty(t)?"[Empty]":e.itemToString?e.itemToString(t):this.itemToString(t)},openEditor:function(){var i=this.modalForm=new e({schema:this.nestedSchema,data:this.value}),s=this.modal=new t.List.Modal.ModalAdapter({content:i,animate:!0});s.open(),this.trigger("open",this),this.trigger("focus",this),s.on("cancel",this.onModalClosed,this),s.on("ok",_.bind(this.onModalSubmitted,this))},onModalSubmitted:function(){var e=this.modal,t=this.modalForm,i=!this.value,s=t.validate();return s?e.preventClose():(this.value=t.getValue(),this.renderSummary(),i&&this.trigger("readyToAdd"),this.trigger("change",this),this.onModalClosed(),void 0)},onModalClosed:function(){this.modal=null,this.modalForm=null,this.trigger("close",this),this.trigger("blur",this)},getValue:function(){return this.value},setValue:function(e){this.value=e},focus:function(){this.hasFocus||this.openEditor()},blur:function(){this.hasFocus&&this.modal&&this.modal.trigger("cancel")}},{ModalAdapter:Backbone.BootstrapModal,isAsync:!0}),t.List.Object=t.List.Modal.extend({initialize:function(){t.List.Modal.prototype.initialize.apply(this,arguments);var e=this.schema;if(!e.subSchema)throw'Missing required option "schema.subSchema"';this.nestedSchema=e.subSchema}}),t.List.NestedModel=t.List.Modal.extend({initialize:function(){t.List.Modal.prototype.initialize.apply(this,arguments);var e=this.schema;if(!e.model)throw'Missing required option "schema.model"';var i=e.model.prototype.schema;this.nestedSchema=_.isFunction(i)?i():i},getStringValue:function(){var e=this.schema,t=this.getValue();return _.isEmpty(t)?null:e.itemToString?e.itemToString(t):""+new e.model(t)}})}(),StringBuffer.prototype.append=function(e){return this.buffer.push(e),this},StringBuffer.prototype.toString=function(){return this.buffer.join("")};var Base64={codex:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){for(var t=new StringBuffer,i=new Utf8EncodeEnumerator(e);i.moveNext();){var s=i.current;i.moveNext();var n=i.current;i.moveNext();var r=i.current,a=s>>2,o=(3&s)<<4|n>>4,l=(15&n)<<2|r>>6,h=63&r;isNaN(n)?l=h=64:isNaN(r)&&(h=64),t.append(this.codex.charAt(a)+this.codex.charAt(o)+this.codex.charAt(l)+this.codex.charAt(h))}return""+t},decode:function(e){for(var t=new StringBuffer,i=new Base64DecodeEnumerator(e);i.moveNext();){var s=i.current;if(128>s)t.append(String.fromCharCode(s));else if(s>191&&224>s){i.moveNext();var n=i.current;t.append(String.fromCharCode((31&s)<<6|63&n))}else{i.moveNext();var n=i.current;i.moveNext();var r=i.current;t.append(String.fromCharCode((15&s)<<12|(63&n)<<6|63&r))}}return""+t}};Utf8EncodeEnumerator.prototype={current:Number.NaN,moveNext:function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=Number.NaN,!1;var e=this._input.charCodeAt(++this._index);return 13==e&&10==this._input.charCodeAt(this._index+1)&&(e=10,this._index+=2),128>e?this.current=e:e>127&&2048>e?(this.current=192|e>>6,this._buffer.push(128|63&e)):(this.current=224|e>>12,this._buffer.push(128|63&e>>6),this._buffer.push(128|63&e)),!0}},Base64DecodeEnumerator.prototype={current:64,moveNext:function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=64,!1;var e=Base64.codex.indexOf(this._input.charAt(++this._index)),t=Base64.codex.indexOf(this._input.charAt(++this._index)),i=Base64.codex.indexOf(this._input.charAt(++this._index)),s=Base64.codex.indexOf(this._input.charAt(++this._index)),n=e<<2|t>>4,r=(15&t)<<4|i>>2,a=(3&i)<<6|s;return this.current=n,64!=i&&this._buffer.push(r),64!=s&&this._buffer.push(a),!0}};var bootbox=window.bootbox||function(e,t){function i(e,t){return t===void 0&&(t=s),"string"==typeof c[t][e]?c[t][e]:t!=n?i(e,n):e}var s="en",n="en",r=!0,a="static",o="",l={},h={},u={setLocale:function(e){for(var t in c)if(t==e)return s=e,void 0;throw Error("Invalid locale: "+e)},addLocale:function(e,t){c[e]===void 0&&(c[e]={});for(var i in t)c[e][i]=t[i]},setIcons:function(e){h=e,("object"!=typeof h||null===h)&&(h={})},setBtnClasses:function(e){l=e,("object"!=typeof l||null===l)&&(l={})},alert:function(){var e="",t=i("OK"),s=null;switch(arguments.length){case 1:e=arguments[0];break;case 2:e=arguments[0],"function"==typeof arguments[1]?s=arguments[1]:t=arguments[1];break;case 3:e=arguments[0],t=arguments[1],s=arguments[2];break;default:throw Error("Incorrect number of arguments: expected 1-3")}return u.dialog(e,{label:t,icon:h.OK,"class":l.OK,callback:s},{onEscape:s||!0})},confirm:function(){var e="",t=i("CANCEL"),s=i("CONFIRM"),n=null;switch(arguments.length){case 1:e=arguments[0];break;case 2:e=arguments[0],"function"==typeof arguments[1]?n=arguments[1]:t=arguments[1];break;case 3:e=arguments[0],t=arguments[1],"function"==typeof arguments[2]?n=arguments[2]:s=arguments[2];break;case 4:e=arguments[0],t=arguments[1],s=arguments[2],n=arguments[3];break;default:throw Error("Incorrect number of arguments: expected 1-4")}var r=function(){return"function"==typeof n?n(!1):void 0};return u.dialog(e,[{label:t,icon:h.CANCEL,"class":l.CANCEL,callback:r},{label:s,icon:h.CONFIRM,"class":l.CONFIRM,callback:function(){return"function"==typeof n?n(!0):void 0}}],{onEscape:r})},prompt:function(){var e="",s=i("CANCEL"),n=i("CONFIRM"),r=null,a="";switch(arguments.length){case 1:e=arguments[0];break;case 2:e=arguments[0],"function"==typeof arguments[1]?r=arguments[1]:s=arguments[1];break;case 3:e=arguments[0],s=arguments[1],"function"==typeof arguments[2]?r=arguments[2]:n=arguments[2];break;case 4:e=arguments[0],s=arguments[1],n=arguments[2],r=arguments[3];break;case 5:e=arguments[0],s=arguments[1],n=arguments[2],r=arguments[3],a=arguments[4];break;default:throw Error("Incorrect number of arguments: expected 1-5")}var o=t("<form></form>");o.append("<input autocomplete=off type=text value='"+a+"' />");var a=function(){return"function"==typeof r?r(null):void 0},c=u.dialog(o,[{label:s,icon:h.CANCEL,"class":l.CANCEL,callback:a},{label:n,icon:h.CONFIRM,"class":l.CONFIRM,callback:function(){return"function"==typeof r?r(o.find("input[type=text]").val()):void 0}}],{header:e,show:!1,onEscape:a});return c.on("shown",function(){o.find("input[type=text]").focus(),o.on("submit",function(e){e.preventDefault(),c.find(".btn-primary").click()})}),c.modal("show"),c},dialog:function(i,s,n){function l(){var e=null;"function"==typeof n.onEscape&&(e=n.onEscape()),!1!==e&&b.modal("hide")}var h="",u=[];n||(n={}),s===void 0?s=[]:s.length===void 0&&(s=[s]);for(var c=s.length;c--;){var d=null,f=null,m=null,p="",v=null;if(s[c].label===void 0&&s[c]["class"]===void 0&&s[c].callback===void 0){var g,d=0,f=null;for(g in s[c])if(f=g,++d>1)break;1==d&&"function"==typeof s[c][g]&&(s[c].label=f,s[c].callback=s[c][g])}"function"==typeof s[c].callback&&(v=s[c].callback),s[c]["class"]?m=s[c]["class"]:c==s.length-1&&2>=s.length&&(m="btn-primary"),d=s[c].label?s[c].label:"Option "+(c+1),s[c].icon&&(p="<i class='"+s[c].icon+"'></i> "),f=s[c].href?s[c].href:"javascript:;",h="<a data-handler='"+c+"' class='btn "+m+"' href='"+f+"'>"+p+d+"</a>"+h,u[c]=v}c=["<div class='bootbox modal' tabindex='-1' style='overflow:hidden;'>"],n.header&&(m="",(n.headerCloseButton===void 0||n.headerCloseButton)&&(m="<a href='javascript:;' class='close'>&times;</a>"),c.push("<div class='modal-header'>"+m+"<h3>"+n.header+"</h3></div>")),c.push("<div class='modal-body'></div>"),h&&c.push("<div class='modal-footer'>"+h+"</div>"),c.push("</div>");var b=t(c.join("\n"));return(n.animate===void 0?r:n.animate)&&b.addClass("fade"),(h=n.classes===void 0?o:n.classes)&&b.addClass(h),b.find(".modal-body").html(i),b.on("keyup.dismiss.modal",function(e){27===e.which&&n.onEscape&&l("escape")}),b.on("click","a.close",function(e){e.preventDefault(),l("close")}),b.on("shown",function(){b.find("a.btn-primary:first").focus()}),b.on("hidden",function(){b.remove()}),b.on("click",".modal-footer a",function(e){var i=t(this).data("handler"),n=u[i],r=null;i!==void 0&&s[i].href!==void 0||(e.preventDefault(),"function"==typeof n&&(r=n()),!1!==r&&b.modal("hide"))}),t("body").append(b),b.modal({backdrop:n.backdrop===void 0?a:n.backdrop,keyboard:!1,show:!1}),b.on("show",function(){t(e).off("focusin.modal")}),(n.show===void 0||!0===n.show)&&b.modal("show"),b},modal:function(){var e,i,s,n={onEscape:null,keyboard:!0,backdrop:a};switch(arguments.length){case 1:e=arguments[0];break;case 2:e=arguments[0],"object"==typeof arguments[1]?s=arguments[1]:i=arguments[1];break;case 3:e=arguments[0],i=arguments[1],s=arguments[2];break;default:throw Error("Incorrect number of arguments: expected 1-3")}return n.header=i,s="object"==typeof s?t.extend(n,s):n,u.dialog(e,[],s)},hideAll:function(){t(".bootbox").modal("hide")},animate:function(e){r=e},backdrop:function(e){a=e},classes:function(e){o=e}},c={en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},ru:{OK:"OK",CANCEL:"Отмена",CONFIRM:"Применить"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"}};return u}(document,window.jQuery);window.bootbox=bootbox,function(e){var t={preload:function(t){return this._preloadCount=0,this.each(e.proxy(function(i,s){this.templatePath=e(s).attr("href"),this.templateName=e(s).attr("id")||this.attr("data-templateName"),e(this).data("template")?t&&i==this.length-1&&e.isFunction(t)&&t.call(this):e.ajax({type:"GET",url:this.templatePath,context:this,success:function(i){this._preloadCount++,e(s).data("template",i),t&&this._preloadCount==this.length&&e.isFunction(t)&&t.call(this)}})},this))},render:function(i,s){if(s===void 0)throw Error("Missing the callback attribute in Chevron render method");return this.each(function(){this.renderData=i,this.callback=s,this.templatePath=e(this).attr("href"),this.templateName=e(this).attr("id")||e(this).attr("data-templateName"),e(this).data("template")?t.invokeRender.call(this,e(this).data("template")):e.ajax({type:"GET",url:this.templatePath,success:e.proxy(t.invokeRender,this)})})},renderTemplate:function(e,t){return Mustache.to_html(e,t)},invokeRender:function(i){e(this).data("template")||e(this).data("template",i);var s=t.renderTemplate(i,this.renderData);if(e.isFunction(this.callback))this.callback.call(this,s);else if(this.callback instanceof jQuery)this.callback.html(s);else{if("string"!=typeof this.callback)throw Error("Chevron render method received an unsuported callback type");e(this.callback).html(s)}}};e.Chevron=e.fn.Chevron=function(i){var s=this;if(s.selector||(s=e("link[rel=template]")),t[i])return t[i].apply(s,Array.prototype.slice.call(arguments,1));throw i?Error("Method "+i+" does not exist on Chevron"):Error("Chevron must receive a method to call as first argument")}}(jQuery);